<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Orders</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <nav>
    <a href="index.html">Home</a> |
    <a href="cart.html">Cart</a> |
    <a href="order.html">Orders</a>
  </nav>

  <h1>Your Orders</h1>

  <div id="orders"></div>

  <script>
    const token = localStorage.getItem('token');

    fetch('/api/orders', {
      headers: { 'Authorization': 'Bearer ' + token }
    })
      .then(res => res.json())
      .then(orders => {
        const container = document.getElementById('orders');

        if (!orders.length) {
          container.innerHTML = '<p>No orders found.</p>';
          return;
        }

        orders.forEach(order => {
          const div = document.createElement('div');
          div.className = 'product-card';
          const date = new Date(order.createdAt).toLocaleString();
          let itemsHTML = '';
          order.items.forEach(item => {
            itemsHTML += `<li>${item.productId.name} Ã— ${item.quantity}</li>`;
          });

          div.innerHTML = `
            <strong>Order Date:</strong> ${date} <br>
            <strong>Total:</strong> $${order.total.toFixed(2)} <br>
            <ul>${itemsHTML}</ul>
          `;

          container.appendChild(div);
        });
      })
      .catch(err => {
        console.error(err);
        alert('Failed to load orders.');
      });
  </script>
</body>
</html>
